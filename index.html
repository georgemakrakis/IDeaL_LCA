<!DOCTYPE>
<!Designed by Amin Mirkouei>
<html class="ie ie7 no-js" lang="en-US">
<html class="ie ie8 no-js" lang="en-US">
<html class="no-js" lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IDEAL Research Group @ Uni. of Idaho</title>
    <link rel="stylesheet" href="css/Ica.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css">
  <link href="twoColLiqLtHdr.css" rel="stylesheet" type="text/css" />
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-101336701-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
  if (typeof jQuery == 'undefined') {
      document.write(unescape("%3Cscript src='/js/jquery-3.5.1.min.js' type='text/javascript'%3E%3C/script%3E"));
  }
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
  <script>
    if (typeof jQuery == 'undefined') {
        document.write(unescape("%3Cscript src='/js/jquery.csv-0.71.min.js' type='text/javascript'%3E%3C/script%3E"));
    }
  </script>

  <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.6.4/js/dataTables.buttons.min.js"></script>

  <!-- The library for the pdf creation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.1.1/jspdf.umd.min.js" type="module"></script>

  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <!-- Move the logic at the end of this file to lca.js -->
  <script src="js/lca.js"></script>

  <script>
    // window.onload = function () {
    //   var chart = JSC.chart('chartContainer', { 
    //     debug: true,
    //     defaultSeries_type: 'column', 
    //     title_label_text: 'Acme Tool Sales', 
    //     yAxis: { label_text: 'Units Sold' }, 
    //     xAxis_label_text: 'Quarter', 
    //     series: [ 
    //       { 
    //         name: 'Time Consumption (min)', 
    //         id: 's1', 
    //         points: [ 
    //           { x: 'Current Approach', y: 20 }, 
    //           { x: 'Proposed Approach', y: 15 }            
    //         ] 
    //       }, 
    //       { 
    //         name: 'Emission (lb CO2)', 
    //         points: [ 
    //         { x: 'Current Approach', y: 0.03 }, 
    //         { x: 'Proposed Approach', y: 0.02 }  
    //         ] 
    //       }, 
    //       { 
    //         name: 'Healty Population (0-1)', 
    //         points: [ 
    //         { x: 'Current Approach', y: 0.5 }, 
    //         { x: 'Proposed Approach', y: 0.8 }  
    //         ] 
    //       }        
    //     ] 
    //   }); 
    // }
    
    window.onload = function () {
      var ctx = document.getElementById('myChart').getContext('2d');
      var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'bar',

        // The data for our dataset
        data: {
            labels: ['Current Approach', 'Proposed Approach'],
            datasets: [{
              label: 'Time Consumption (min)',
              backgroundColor: 'rgb(0, 128, 255)',
              borderColor: 'rgb(0, 128, 255)',
              data: [20, 15]
            },
            {
              label: 'Emission (lb CO2)',
              backgroundColor: 'rgb(0, 204, 0)',
              borderColor: 'rgb(0, 204, 0)',
              data: [0.03, 0.02]
            },
           {
              label: 'Healty Population (0-1)',
              backgroundColor: 'rgb(255, 0, 0)',
              borderColor: 'rgb(255, 0, 0)',
              data: [0.5, 0.8]
           }]
        },

        // Configuration options go here
        options: {
          responsive: true,
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: true,
                steps: 10,
                stepSize: 6,
                max: 40 //max value for the chart is 60
              }
            }]
          }
        }        
      });
    }
    
  </script>

</head>

<body>
  <div class="container">
    <div class="header">
      <div>
      <div style="height: 35px; background-color: #FFC300  ; border-bottom: #000000; margin-bottom: 10px;">
      </div>
      <h2 class="text">
      <a href="https://www.uidaho.edu/idaho-falls">
      <img src="UI.JPG" class="panel" style="width: 271px; height: 90px; float: left;" /></a></h2>
      <h2 class="panel" align="center">Innovative Design and Manufacturing Laboratory<img src="ideal.JPG" class="panel" style="width: 271px; height: 90px; float:right;" /></a></h2>
      <h2 class="panel" align="center">PI: Dr. Amin Mirkouei</a></h2></div>
      <div style="height: 17px; background-color: #808080; border-bottom: #b39700; margin-bottom: 30px;">
      </div>
      <!-- end .header --></div>
    
    <div class="sidebar1">
        <nav class="menu">
      <p><a href="index.html">Home</a></p>
            <p><a href="lca.html">LCA</a></p>
      <p><a href="economic.html">Economic Assessment</a></p>
      <p><a href="environmental.html">Envorinmental Assessment</a></p>
      <p><a href="social.html">Social Assessment</a></p>
      </nav>
    <!-- end .sidebar1 --></div>
  
  <div class="content" style="width: 70%">
  <!-- LCA -->
  <article id="Life Cycle Assessment" class="panel">
  <header>
  <h2>Life Cycle Assessment (LCA)</h2>

  <p align="justify" class="panel">An open-source software for LCA and sustainability assessment is under construction in this webpage.</p>
  <p>&nbsp;</p>
  <h3>Getting started:</h3>
  <li style="font-size:12pt"> Manuals, case studies, and databases are available <b><a href="manual.html">here.</b></a></li>
    
  <p>&nbsp;</p>
  <h3>-----------------------------------</h3>
  <h3>Name of the project, Name and Email:</h3>

  <table>
    <tr>
      <td><input id="projectName" type="text" name="projectName" placeholder="Name of the project" /></td>
    </tr>
    <tr>
      <td><input id="name" type="text" name="name" placeholder="Name" /></td>
      <td><input id="email" type="email" name="email" placeholder="Email" /></td>
    </tr>
    </table>
    

  <p>&nbsp;</p>
  <h3>-----------------------------------</h3>
  <h3>Phase 1. Goal and scope definition:</h3>
  <li style="font-size:12pt"> <b>Define your goal, scope, system boundary, functional unit, and case study assumptions down here:</b></li>
  
  <textarea id="phase1Text" name="phase1Text" rows="4" cols="50">
    
  </textarea>

  <li style="font-size:12pt"> <b>Example:</b> LCA performed herein evaluates GWP for the manure to valueadded
  products life cycle. GHG emission factors are used to calculate the
  GWP (in kg CO2 equivalent) with the key factors being 28 kg CO2 eq./kg
  CH4 and 265 kg CO2 eq./kg N2O, which are acquired from the Intergovernmental
  Panel on Climate Change for a 100-year time horizon. The <b>scope</b> of this study includes four distinct stages that can be
  categorized into two processes: (i) upstream processes, including raw material (cattle manure) collection, and (ii) midstream processes,
  involving on-site pretreatment (dewatering and size reduction), on-site converting manure to intermediate products (biochar, bio-oil, and pyrolysis
  gas), on-site reusing intermediate products (e.g., bio-oil and pyrolysis gas) for pretreatment purposes (i.e., heat and electricity), and
  biochar distribution. This <b>scope considers a cradle-to-gate system boundary</b>. The <b>functional unit</b> in this study is one kilogram of
  biochar, using the identified scope.</li>

  <h3>-----------------------------------</h3>
  <h3>Phase 2. Life cycle inventory (LCI):</h3>
  <li style="font-size:12pt"> Creating a database</li>
  <p>&nbsp;</p>
  <li style="font-size:12pt"> Importing a database</li>
  <p>&nbsp;</p>

  <div class="container mt-4">
    <div id="dvImportSegments" class="fileupload ">
      <fieldset>
        <legend>Upload your CSV File</legend>
            <input type="file" name="File Upload" id="txtFileUpload" accept=".csv" />
     </fieldset>
     <div id="csv-display">
        <table id="CSVtable" class="display">     
        </table>
     </div>
  </div>
  </div>

  <p>&nbsp;</p>
  <li style="font-size:12pt"> Exporting a database</li>
  <p>&nbsp;</p>
  <h3>-----------------------------------</h3>
  <h3>Phase 3. Life cycle impat assessment (LCIA):</h3>
  <li style="font-size:12pt"> Method selection</li>
  <!-- The same name allows the one of the two radio buttons to be selected -->
  <input type="checkbox" id="method1" name="method" value="method1">
  <label for="method1"><i>Method 1 - CML-baseline</i> X*Y+Z*Y1 = GWP</label><br>
  <p>&nbsp;</p>
  <input type="checkbox" id="method2" name="method" value="method2">
  <label for="method2"><i>Method 2 - CML-baseline</i> X*Y+Z*Y1 = GWP</label><br>
  <p>&nbsp;</p>
  <input type="checkbox" id="method3" name="method" value="method3">
  <label for="method3"><i>Method 3 - CML-baseline</i> X*Y+Z*Y1 = GWP</label><br>
  <p>&nbsp;</p>
  
  
  <input type="checkbox" id="method4" name="method" value="method4">
  <label for="method4"><i>Method 2 - Developed by user (TBA)</i></label><br>

  <h3>-----------------------------------</h3>

  <p>&nbsp;</p>
  <li style="font-size:12pt">Results</li>
  <p id='GWPupstream'>GWPupstream =</p>
  <p id='GWPmidstream'>GWPmidstream = </p>
  <p id='GWPtranportation'>GWPtranportation = </p>

  <p>&nbsp;</p>

  <h3>-----------------------------------</h3>
  <h3>Phase 4: Interpretation:</h3>
  <li style="font-size:12pt"> Analyzing the results and comparison</li>
  <p>Table</p>
  <p>Plot</p>

  <canvas id="myChart" style="height: 370px; width: 100%;"></canvas>
  <p>&nbsp;</p>
  <li style="font-size:12pt"> Generating a PDF report <button type="reportButton" id="generateReport">Generate</button></li>
  <p>&nbsp;</p>

</ul>
<p>&nbsp;</p>
  
  
  <p>&nbsp;</p>	
<!-- end .content --></div>
<div class="footer">
  </i></a></span></div>
      <p>  &copy; 2018 IDeaL . <a href="http://www.uidaho.edu/" align="center" title="IDeaL Research Group" 
  rel="bookmark"; float: center">University of Idaho</a></p>		
</div>	      			
</div>



  <p>&nbsp;</p>
<!-- end .footer --></div>
<!-- end .container --></div>
</body>

<script type="text/javascript">    
  $(document).ready(function() {

    var table = null;

    // Here once the user select the appropraite checkbox, we perform the corresponding calculation
    $('input:checkbox[name="method"]').change(
    function(){    
      if (this.checked && this.value == 'method1' && table != null) {
          var results = $('#GWPupstream');        
          // var data  = table.rows({selected: true}).data()[0];
          // var result = data[0]*data[1]+data[2]*data[3];

          // We only need from columns 1-6 correct? (No the first column?)
          var columnData = table.columns([1,2,3,4,5,6]).data();
          var rowsData = table.rows().data();          

          var uniqueCountries = Array.from(new Set(columnData[1]));

          var w_i = 1;

          // We traverse all rows to perform the required multiplication
          rowsData.each(row => {
            w_i *= row[6]; // be carefull, here whe count from 0..n not from 1            
            
          });

          // be carefull, here whe count from 0..n not from 1
          var result = (columnData[0].length * uniqueCountries.length * w_i) / columnData[0].length;
                   
          // console.log(result);

          results.replaceWith("<p id='GWPupstream'>GWPupstream = <i>"+result+"</i></p>")
          // results.append($( "<i>"+result+"</i>"));
        }
    });

    // The event listener for the file upload
    document.getElementById('txtFileUpload').addEventListener('change', upload, false);

    // Method that checks that the browser supports the HTML5 File API
    function browserSupportFileUpload() {
        var isCompatible = false;
        if (window.File && window.FileReader && window.FileList && window.Blob) {
        isCompatible = true;
        }
        return isCompatible;
    }

    // Method that reads and processes the selected file
    function upload(evt) {
    if (!browserSupportFileUpload()) {
        alert('The File APIs are not fully supported in this browser!');
        } 
        else {
            var data = null;
            var file = evt.target.files[0];
            var reader = new FileReader();
            reader.readAsText(file);
            reader.onload = function(event) {
                var csvData = event.target.result;
                data = $.csv.toArrays(csvData);   
                
                // We clear the table from previous data
                if(table!=null)
                {
                  table.destroy();
                  $('#CSVtable').empty();
                }
                table = populateTable(data);

            };
            reader.onerror = function() {
                alert('Unable to read ' + file.fileName);
            };
        }
    }

    $("#generateReport").click(function(){      

      //Get the 

      // Get the canvas from the HTML
      var canvas = document.querySelector('#myChart');
      //creates image
      var canvasImg = canvas.toDataURL("image/jpeg", 1.0);
      
      //creates PDF from img
      var doc = new jspdf.jsPDF();
      doc.setFontSize(20);
      // doc.text(15, 15, "Cool Chart");
      doc.addImage(canvasImg, 'JPEG', 10, 10, 180, 160 );                    
      doc.save('report.pdf')
    });


  });
  
  function populateTable(dataSet){
    if(typeof(dataSet[0]) === 'undefined') {
        return null;
    } 
    else {
      var columns = [];
      var data = [];
      $.each(dataSet, function( index, row ) {

        // The first row of the csv data is going to be represent each column in our HTML table
        if(index == 0) {
            $.each(row, function( index, colData ) {
              columns.push({ title: colData});
            });
        } // Then we just have the rest of the data
        else{         
          data.push(row); 
        }

      });
     

      // We assign the above data and columns and some attributes to display on the table.
      return table = $('#CSVtable').DataTable( {        
        data: data,
        columns: columns,
        select: {
            style: 'single',
            items: 'row'
        },
        // dom: 'Bfrtip',
        // buttons: [
        //     {
        //         text: 'Get selected data',
        //         action: function () {
        //             // var count = table.rows( { selected: true } ).count();
 
        //             // events.prepend( '<div>'+count+' row(s) selected</div>' );
        //             // console.log(table.rows({seleted: true}).data()[0]);
        //             var data  = table.rows({seleted: true}).data()[0];

        //             var result = data[0]*data[1]+data[2]*data[3];
        //             console.log(data);

        //             results.append($( "<i>"+result+"</i>"));
        //         }
        //     }
        // ]        
      });           
  }
  

}
  
</script>

<!-- The library for the charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

<!--LCA Tool ends-->
